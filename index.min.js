var player,lineCount,tweetCount,tweetSpawn,facebookSpawn,facebookCount,instaSpeed,instaCounter,insta,finalScore,score,board,keys=[],lines=[],tweets=[],facebooks=[],interval=20,start=!0,over=!1,win=!1,invincible=!1;function startGame(){race.start(),initialize()}function initialize(){if(score=0,finalScore=0,lineCount=50,tweetCount=0,tweetSpawn=1e3,facebookSpawn=400,facebookCount=0,instaSpeed=2500,instaCounter=0,player=new turtle(race.canvas.width/2-50,race.canvas.height-250),insta=new instagram,board=new scoreBoard,lines.length<lineCount)for(var t=0;t<lineCount;t++)lines.push(new backLine)}function updateGame(){race.clear();for(var t=0;t<lines.length;t++)lines[t].update(),lines[t].move();if(start)startScreen(),keys[32]&&(start=!1,initialize(),over=!1,win=!1);else if(over)over&&win?(winner(),keys[32]&&(initialize(),over=!1,win=!1)):(gameOver(),keys[32]&&(initialize(),over=!1));else{player.speedX=0,player.speedY=0,keys[73]&&(invincible=!0),keys[85]&&(invincible=!1),keys[37]&&(player.speedX=-7),keys[39]&&(player.speedX=7),keys[38]&&(player.speedY=-7),keys[40]&&(player.speedY=7),player.move(),player.update();var e=player.hp;for(t=0;t<facebooks.length;t++){for(;facebooks[t].finished()&&(facebooks.splice(t,1),!(t>=facebooks.length)););facebooks[t].move(),facebooks[t].update(),facebooks[t].hit()&&!invincible&&(player.hp-=1,player.color="red",player.hp<=0&&(over=!0))}for(t=0;t<tweets.length;t++){for(;tweets[t].finished()&&(tweets.splice(t,1),!(t>=tweets.length)););if(t>=tweets.length)break;tweets[t].move(),tweets[t].update(),tweets[t].hit()&&!invincible&&(player.hp-=1,player.color="red",player.hp<=0&&(over=!0))}e===player.hp&&(player.color="green"),insta.finished()||(insta.move(),insta.update()),score+=1,board.update(),facebookDificulty(),twitterDifficulty(),instagramDifficulty(),score>=13e3&&(finalScore=13e3,over=!0,win=!0)}}function facebookDificulty(){for(;facebookCount>facebooks.length;)console.log("Adding a facebook instance"),facebooks.push(new facebook);facebookCount=score/facebookSpawn}function startScreen(){ctx=race.context,ctx.font="60px Arial",ctx.textAlign="center",ctx.fillText("Awkward",race.canvas.width/2,race.canvas.height/2-30),ctx.fillText("Turtle",race.canvas.width/2,race.canvas.height/2+30),space(ctx)}function space(t){t.font="20px Arial",t.textAlign="center",t.fillText("Press Space to Start!",race.canvas.width/2,race.canvas.height-100)}function winner(){facebooks=[],tweets=[],insta=null,player=null,board=null,ctx=race.context,race.canvas.style.webkitFilter="blur(0px)",ctx.font="60px Arial",ctx.textAlign="center",ctx.fillStyle="green",ctx.fillText("YOU WIN!",race.canvas.width/2,race.canvas.height/2),ctx.font="80px Arial",ctx.textAlign="center",ctx.fillStyle=getRandomColour(),ctx.fillText(finalScore,race.canvas.width/2,race.canvas.height/2-100),space(ctx)}function gameOver(){facebooks=[],tweets=[],insta=null,player=null,board=null,finalScore=score,ctx=race.context,race.canvas.style.webkitFilter="blur(0px)",ctx.font="60px Arial",ctx.textAlign="center",ctx.fillStyle="red",ctx.fillText("GAME OVER",race.canvas.width/2,race.canvas.height/2),ctx.font="30px Arial",ctx.fillText(finalScore,race.canvas.width/2,race.canvas.height/2+50),space(ctx)}function twitterDifficulty(){for(;tweetCount>tweets.length;)tweets.push(new twitter);tweetCount=score/tweetSpawn}function instagramDifficulty(){instaCounter>=instaSpeed?(console.log("flash"),instaSpeed-=10,insta.init(),instaCounter=0):instaCounter+=1}var race={canvas:document.createElement("canvas"),start:function(){this.canvas.width=500,this.canvas.height=800,this.context=this.canvas.getContext("2d"),document.body.insertBefore(this.canvas,document.body.childNodes[0]),this.interval=setInterval(updateGame,interval),window.addEventListener("keydown",function(t){keys[t.keyCode]=!0}),window.addEventListener("keyup",function(t){keys[t.keyCode]=!1})},clear:function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)}};function getRandomColour(){return"rgb("+Math.floor(255*Math.random())+","+Math.floor(255*Math.random())+","+Math.floor(255*Math.random())+")"}function backLine(){this.X=Math.floor(Math.random()*race.canvas.width),this.Y=-1*Math.floor(300*Math.random()),this.width=Math.floor(6*Math.random()),this.length=Math.floor(100*Math.random())+50,this.speed=Math.floor(5*Math.random())+1,this.color=getRandomColour(),this.update=function(){ctx=race.context,ctx.beginPath(),ctx.strokeStyle=this.color,ctx.moveTo(this.X,this.Y),ctx.lineWidth=this.width,ctx.lineTo(this.X,this.Y-this.length),ctx.closePath(),ctx.stroke()},this.move=function(){this.Y>race.canvas.height+this.length&&(this.Y=-1*Math.floor(300*Math.random()),this.X=Math.floor(Math.random()*race.canvas.width),this.width=Math.floor(6*Math.random()),this.length=Math.floor(100*Math.random())+50,this.speed=Math.floor(5*Math.random())+1,this.color=getRandomColour()),this.Y+=this.speed}}function turtle(t,e){this.X=t,this.Y=e,this.speedX=0,this.speedY=0,this.frameSpeed=15,this.currentFrame=0,this.hp=300,this.color="green",this.update=function(){ctx=race.context,ctx.beginPath(),ctx.moveTo(this.X+25,this.Y+5),ctx.bezierCurveTo(this.X+50,this.Y+5,this.X+50,this.Y+50,this.X+25,this.Y+50),ctx.bezierCurveTo(this.X,this.Y+50,this.X,this.Y+5,this.X+25,this.Y+5),ctx.closePath(),ctx.fillStyle="brown",ctx.fill(),ctx.beginPath(),ctx.moveTo(this.X+25,this.Y+10),ctx.bezierCurveTo(this.X+45,this.Y+10,this.X+45,this.Y+45,this.X+25,this.Y+45),ctx.bezierCurveTo(this.X+5,this.Y+45,this.X+5,this.Y+10,this.X+25,this.Y+10),ctx.closePath(),ctx.fillStyle="yellow",ctx.strokeStyle="white",ctx.lineWidth=3,ctx.fill(),ctx.stroke(),ctx.beginPath(),ctx.moveTo(this.X+13,this.Y+20),ctx.lineTo(this.X+37,this.Y+20),ctx.moveTo(this.X+10,this.Y+30),ctx.lineTo(this.X+40,this.Y+30),ctx.moveTo(this.X+15,this.Y+40),ctx.lineTo(this.X+35,this.Y+40),ctx.closePath(),ctx.strokeStyle="black",ctx.lineWidth=1,ctx.stroke(),ctx.beginPath(),ctx.moveTo(this.X+25,this.Y),ctx.bezierCurveTo(this.X+35,this.Y,this.X+35,this.Y+15,this.X+25,this.Y+15),ctx.bezierCurveTo(this.X+15,this.Y+15,this.X+15,this.Y,this.X+25,this.Y),ctx.closePath(),ctx.fillStyle=this.color,ctx.fill(),ctx.beginPath(),ctx.moveTo(this.X+15,this.Y+15),ctx.lineTo(this.X+10,this.Y+10),ctx.closePath(),ctx.strokeStyle=this.color,ctx.lineWidth=5,ctx.stroke(),ctx.beginPath(),ctx.moveTo(this.X+35,this.Y+15),ctx.lineTo(this.X+40,this.Y+10),ctx.closePath(),ctx.strokeStyle=this.color,ctx.lineWidth=5,ctx.stroke(),ctx.beginPath(),ctx.moveTo(this.X+15,this.Y+40),ctx.lineTo(this.X+10,this.Y+45),ctx.closePath(),ctx.strokeStyle=this.color,ctx.lineWidth=5,ctx.stroke(),ctx.beginPath(),ctx.moveTo(this.X+35,this.Y+40),ctx.lineTo(this.X+40,this.Y+45),ctx.closePath(),ctx.strokeStyle=this.color,ctx.lineWidth=5,ctx.stroke(),ctx.beginPath(),ctx.moveTo(this.X+20,this.Y),ctx.lineTo(this.X+20,this.Y+5),ctx.closePath(),ctx.strokeStyle="black",ctx.lineWidth=2,ctx.stroke(),ctx.beginPath(),ctx.moveTo(this.X+30,this.Y),ctx.lineTo(this.X+30,this.Y+5),ctx.closePath(),ctx.strokeStyle="black",ctx.lineWidth=2,ctx.stroke(),ctx.beginPath(),ctx.moveTo(race.canvas.width-50,50),ctx.lineTo(race.canvas.width-50-this.hp,50),ctx.closePath(),ctx.strokeStyle="red",ctx.lineWidth=15,ctx.stroke()},this.move=function(){this.speedX<0&&this.X<=0||this.speedX>0&&this.X>=race.canvas.width-50||(this.X+=this.speedX),this.speedY<0&&this.Y<=5||this.speedY>0&&this.Y>=race.canvas.height-55||(this.Y+=this.speedY)}}function scoreBoard(){this.update=function(){ctx=race.context,ctx.textAlign="left",ctx.font="30px Arial",ctx.fillStyle="purple",ctx.fillText(score,10,30)}}function facebook(){this.X=Math.floor(Math.random()*race.canvas.width),this.Y=-1*Math.floor(100*Math.random()),this.speedX=Math.floor(4*Math.random()),this.speedY=Math.floor(2*Math.random())+1,this.radius=Math.floor(11*Math.random())+15,this.update=function(){ctx=race.context,ctx.beginPath(),ctx.fillStyle="blue",ctx.strokeStyle="black",ctx.font=2*this.radius+"px verdana",ctx.lineWidth=10,ctx.arc(this.X,this.Y,this.radius,0,2*Math.PI,!1),ctx.fill(),ctx.beginPath(),ctx.fillStyle="white",ctx.fillText("f",this.X-5,this.Y+this.radius),ctx.fill(),ctx.closePath(),ctx.stroke()},this.move=function(){this.Y+=this.speedY},this.hit=function(){var t=player.X+25,e=player.Y+25;return Math.sqrt(Math.pow(t-this.X,2)+Math.pow(e-this.Y,2))<=this.radius+25},this.finished=function(){return this.Y-this.radius>=race.canvas.height}}function twitter(){this.X=Math.floor(Math.random()*race.canvas.width)-49,this.Y=-1*Math.floor(100*Math.random()),this.speedX=Math.floor(6*Math.random()),this.speedY=Math.floor(6*Math.random())+3,this.counter=0,this.wingUp=!1,this.direction=0==Math.floor(2*Math.random()),this.init=function(){this.X=Math.floor(Math.random()*race.canvas.width)-49,this.Y=-1*Math.floor(100*Math.random()),this.speedX=Math.floor(6*Math.random()),this.speedY=Math.floor(6*Math.random())+1,this.counter=0,this.wingUp=!1,this.direction=0==Math.floor(2*Math.random())},this.update=function(){ctx=race.context,this.direction?(ctx.beginPath(),ctx.moveTo(this.X+50,this.Y+20),ctx.bezierCurveTo(this.X+50,this.Y,this.X+30,this.Y,this.X+30,this.Y+20),ctx.lineTo(this.X,this.Y+20),ctx.bezierCurveTo(this.X+10,this.Y+50,this.X+40,this.Y+50,this.X+40,this.Y+20),ctx.lineTo(this.X+50,this.Y+20),ctx.closePath(),ctx.fillStyle="#1da1f2",ctx.fill(),ctx.lineWidth=2,ctx.stroke(),this.wingUp?(ctx.beginPath(),ctx.moveTo(this.X+30,this.Y+20),ctx.bezierCurveTo(this.X+20,this.Y+30,this.X,this.Y+10,this.X+10,this.Y),ctx.closePath(),ctx.fillStyle="#1da1f2",ctx.fill(),ctx.lineWidth=2,ctx.stroke()):(ctx.beginPath(),ctx.moveTo(this.X+30,this.Y+20),ctx.bezierCurveTo(this.X+10,this.Y+20,this.X+10,this.Y+40,this.X+30,this.Y+40),ctx.closePath(),ctx.fillStyle="#1da1f2",ctx.fill(),ctx.lineWidth=2,ctx.stroke())):(ctx.beginPath(),ctx.moveTo(this.X,this.Y+20),ctx.bezierCurveTo(this.X,this.Y,this.X+20,this.Y,this.X+20,this.Y+20),ctx.lineTo(this.X+50,this.Y+20),ctx.bezierCurveTo(this.X+40,this.Y+50,this.X+10,this.Y+50,this.X+10,this.Y+20),ctx.lineTo(this.X,this.Y+20),ctx.closePath(),ctx.fillStyle="#1da1f2",ctx.fill(),ctx.lineWidth=2,ctx.stroke(),this.wingUp?(ctx.beginPath(),ctx.moveTo(this.X+20,this.Y+20),ctx.bezierCurveTo(this.X+30,this.Y+30,this.X+50,this.Y+10,this.X+40,this.Y),ctx.closePath(),ctx.fillStyle="#1da1f2",ctx.fill(),ctx.lineWidth=2,ctx.stroke()):(ctx.beginPath(),ctx.moveTo(this.X+20,this.Y+20),ctx.bezierCurveTo(this.X+40,this.Y+20,this.X+40,this.Y+40,this.X+20,this.Y+40),ctx.closePath(),ctx.fillStyle="#1da1f2",ctx.fill(),ctx.lineWidth=2,ctx.stroke()))},this.move=function(){this.X<=0&&(this.direction=!0),this.X>=race.canvas.width-50&&(this.direction=!1),this.counter+=1,this.counter>=10&&(this.wingUp=!this.wingUp,this.counter=0),this.X+=this.direction?this.speedX:-1*this.speedX,this.Y+=this.speedY},this.hit=function(){return this.X+5<player.X+45&&this.X+45>player.X+5&&this.Y+5<player.Y+45&&this.Y+45>player.Y+5&&(console.log("Hit the player!"),!0)},this.finished=function(){return this.Y>=race.canvas.height}}function instagram(){this.X=race.canvas.width/2-50,this.width=100,this.Y=-100,this.height=100,this.durationCounter=0;var t=-1;this.blur=100,this.init=function(){this.durationCounter=0,this.blur=100,t=1,this.Y=-100},this.update=function(){if(t>=1){ctx=race.context,ctx.beginPath();var e=ctx.createLinearGradient(this.X+this.width,this.Y,this.X,this.Y+this.height);e.addColorStop(0,"blue"),e.addColorStop(.4,"purple"),e.addColorStop(.6,"red"),e.addColorStop(1,"yellow"),ctx.fillStyle=e,ctx.fillRect(this.X,this.Y,this.width,this.height),ctx.closePath(),ctx.beginPath(),ctx.fillStyle="white",ctx.arc(this.X+20,this.Y+20,10,0,2*Math.PI),ctx.closePath(),ctx.fill(),ctx.beginPath(),ctx.arc(this.X+50,this.Y+50,25,0,2*Math.PI),ctx.closePath(),ctx.stroke(),t>1&&(ctx=race.context,ctx.beginPath(),ctx.fillStyle="white",ctx.fillRect(0,0,race.canvas.width,race.canvas.height),ctx.closePath(),this.durationCounter+=1,this.durationCounter>50&&(t=0))}else 0==t&&(this.blur-=2,race.canvas.style.webkitFilter="blur("+this.blur+"px)",0==this.blur&&(t=-1))},this.move=function(){this.Y<=25?this.Y+=4:t>0&&(t+=1)},this.finished=function(){return-1==t}}